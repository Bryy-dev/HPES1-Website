import{c,r as m,j as e}from"./index-CHh0W5_2.js";import{u as C}from"./useQuery-DgcdhVhv.js";import{u as R,F as $,a as G,b as p,s as F}from"./formik.esm-DCZ0bABG.js";import{g as _,L as E}from"./loader-CUZWE4u1.js";import{d as I}from"./dateFormmater-loz6_SBV.js";import{m as T}from"./initialStates-C2DwkKKq.js";import{C as U}from"./calendar-jeY8ptxt.js";import"./pdf-worker-BosuxZz1.js";/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],V=c("book-open",q);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],O=c("chevron-left",z);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],H=c("chevron-right",D);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],K=c("download",B);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],J=c("funnel",Q);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Y=c("search",X),Z=()=>{const i="module";return{fetchAll:async()=>_(`${i}/`),search:async r=>_(`${i}/search?${r}`)}},ee=[{key:"week-1",value:"Week 1"},{key:"week-2",value:"Week 2"},{key:"week-3",value:"Week 3"},{key:"week-4",value:"Week 4"},{key:"week-5",value:"Week 5"},{key:"week-6",value:"Week 6"},{key:"week-7",value:"Week 7"},{key:"week-8",value:"Week 8"},{key:"week-9",value:"Week 9"},{key:"week-10",value:"Week 10"},{key:"week-11",value:"Week 11"},{key:"week-12",value:"Week 12"},{key:"week-13",value:"Week 13"},{key:"week-14",value:"Week 14"},{key:"week-15",value:"Week 15"}],ae=[{key:"",value:"All Grade Level"},{key:"grade-1",value:"Grade 1"},{key:"grade-2",value:"Grade 2"},{key:"grade-3",value:"Grade 3"},{key:"grade-4",value:"Grade 4"},{key:"grade-5",value:"Grade 5"},{key:"grade-6",value:"Grade 6"}],se=[{key:"english",value:"English"},{key:"math",value:"Math"},{key:"filipino",value:"Filipino"},{key:"science",value:"Science"},{key:"araling panlipunan",value:"Araling Panlipunan"},{key:"esp",value:"ESP"},{key:"tle",value:"TLE"},{key:"mapeh",value:"Mapeh"},{key:"hekasi",value:"Hekasi"}],M=i=>i.split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()).join(" "),xe=()=>{const[t,v]=m.useState(1);m.useState({gradeLevel:"",subject:"",week:""});const[r,f]=m.useState([]),[P,te]=m.useState(T),g=Array.isArray(r)?Math.ceil(r.length/5):0,j=(t-1)*5,x=Array.isArray(r)?r.slice(j,j+5):[],k=a=>{var l;a>=1&&a<=g&&(v(a),(l=document.getElementById("results-container"))==null||l.scrollIntoView({behavior:"smooth"}))},w=Z(),{data:n,refetch:re,isLoading:N}=C({queryKey:["apiModules"],queryFn:async()=>await w.fetchAll()});m.useEffect(()=>{n!=null&&n.data&&f(n.data)},[n==null?void 0:n.data]);const{mutateAsync:A,isPending:L}=R({mutationKey:[""],mutationFn:async a=>await w.search(a),onMutate:()=>{},onSuccess:a=>{f(a.data),console.log(a)},onError:a=>{}}),W=async a=>{const l=`${a.week}-${a.subject}-${a.topic}-${a.level}-Module.pdf`,h=a.pdf_url,d=new Promise(async(b,y)=>{try{const s=await fetch(h);if(!s.ok)throw new Error("Network response was not ok");const o=await s.blob(),S=window.URL.createObjectURL(o),u=document.createElement("a");u.href=S,u.download=l,document.body.appendChild(u),u.click(),document.body.removeChild(u),window.URL.revokeObjectURL(S),b()}catch(s){y(s)}});F(d,{pending:"Downloading Module...",success:"Download complete!",error:"Download failed!"},{theme:"light",position:"top-right"})};return e.jsxs("div",{className:"lg:bg-white dark:bg-gray-900 p-6 rounded-xl shadow-sm px-8",children:[e.jsx("div",{className:"lg:mb-10 mb-4 py-2",children:e.jsx("h2",{className:"lg:text-4xl text-2xl font-black text-gray-800 dark:text-white",children:e.jsx("span",{className:"bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-cyan-500",children:"Learning Modules"})})}),e.jsxs("div",{className:"lg:px-40",children:[e.jsxs("div",{className:"panel dark:bg-gray-800 p-6 rounded-lg mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(J,{className:"h-5 w-5 text-blue-600"}),e.jsx("h3",{className:"font-semibold text-gray-700 dark:text-gray-200",children:"Filter Modules"})]}),e.jsx($,{enableReinitialize:!0,initialValues:P,onSubmit:async(a,l)=>{const h=Object.entries(a).filter(([b,y])=>y!==""),d=new URLSearchParams(h).toString();console.log(d),A(d)},children:({values:a,setFieldValue:l,errors:h,touched:d,isValid:b,isSubmitting:y})=>e.jsxs(G,{className:"",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:"Grade Level"}),e.jsx(p,{name:"level",as:"select",className:"w-full px-4 py-3 rounded-lg border border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all duration-200 outline-none",children:ae.map((s,o)=>e.jsx("option",{value:s.key,children:s.value},o))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:"Subject"}),e.jsx(p,{name:"subject",as:"select",className:"w-full px-4 py-3 rounded-lg border border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all duration-200 outline-none",children:se.map((s,o)=>e.jsx("option",{value:s.key,children:s.value},o))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:"Week"}),e.jsx(p,{name:"week",as:"select",className:"w-full px-4 py-3 rounded-lg border border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all duration-200 outline-none",children:ee.map((s,o)=>e.jsx("option",{value:s.key,children:s.value},o))})]})]}),e.jsx("div",{className:"flex justify-end items-center py-2",children:e.jsxs("button",{type:"submit",className:"px-4 py-2 text-gray-600 bg-gray-50 border hover:bg-gray-100 rounded-lg transition-colors duration-200 text-sm font-medium flex items-center",children:[e.jsx(Y,{className:"h-4 w-4"}),e.jsx("span",{className:"",children:"Filter Results"})]})})]})})]}),e.jsxs("div",{id:"results-container",className:"space-y-4",children:[N&&e.jsx(E,{}),L&&e.jsx(E,{}),(x==null?void 0:x.length)===0&&e.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[e.jsx(V,{className:"mx-auto h-12 w-12 mb-4 opacity-30"}),e.jsx("p",{className:"text-lg font-medium",children:"No modules found"}),e.jsx("p",{className:"text-sm",children:"Try adjusting your filters to find what you're looking for"})]}),x.map((a,l)=>e.jsx("div",{className:" dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl p-5 shadow-md hover:shadow-lg transition-all transform hover:translate-y-px",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"px-2",children:[e.jsxs("div",{className:"lg:flex grid items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xs font-semibold bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 py-2 px-3 rounded-full",children:M(a.week)}),e.jsx("h3",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:M(a.subject)})]}),e.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200",children:a.topic}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:a.description}),e.jsxs("div",{className:"flex items-center gap-1 mt-2 text-xs text-gray-500 dark:text-gray-400",children:[e.jsx(U,{className:"h-3 w-3"}),e.jsx("span",{children:I(a.discussion_date)})]})]}),e.jsx("div",{className:"md:self-end",children:e.jsxs("button",{type:"button",onClick:()=>W(a),disabled:N,className:"px-4 py-2 text-white bg-blue-400 border hover:bg-blue-500 rounded-lg transition-colors duration-200 text-sm font-medium flex items-center",children:[e.jsx(K,{className:"h-4 w-4"}),e.jsx("span",{className:"ps-1 pt-0.5",children:"Download"})]})})]})},l))]}),r&&(r==null?void 0:r.length)>0&&e.jsx("div",{className:"flex justify-center mt-8",children:e.jsxs("nav",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>k(t-1),disabled:t===1,className:"p-2 rounded-lg enabled:hover:bg-gray-100 dark:enabled:hover:bg-gray-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Previous page",children:e.jsx(O,{className:"h-5 w-5 text-gray-700 dark:text-gray-300"})}),e.jsx("div",{className:"flex space-x-1",children:Array.from({length:g},(a,l)=>l+1).map(a=>e.jsx("button",{onClick:()=>k(a),className:`
                    w-10 h-10 flex items-center justify-center rounded-lg transition-colors
                    ${t===a?"bg-blue-600 text-white font-medium":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}
                  `,children:a},a))}),e.jsx("button",{onClick:()=>k(t+1),disabled:t===g,className:"p-2 rounded-lg enabled:hover:bg-gray-100 dark:enabled:hover:bg-gray-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Next page",children:e.jsx(H,{className:"h-5 w-5 text-gray-700 dark:text-gray-300"})})]})})]})]})};export{xe as default};
