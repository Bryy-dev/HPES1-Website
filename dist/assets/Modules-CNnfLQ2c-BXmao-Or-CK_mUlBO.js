import{j as i,T as m,S as e}from"./index-CkfK2x5R.js";import{B as G}from"./useQuery-DgcdhVhv-8wfc_FFO-zEQPiMpe.js";import{B as C,H as R,V as U,G as p,W as V}from"./formik.esm-DCZ0bABG-D05nK4Yh-BZVot_Tu.js";import{O as W,E as A}from"./loader-CUZWE4u1-Bc9zbGhW-DbwShRTX.js";import{e as B}from"./dateFormmater-loz6_SBV-D2FhJicJ-Zs-g7UCO.js";import{a as F}from"./initialStates-C2DwkKKq-B6C2u25H-DZY_zHND.js";import{a as H}from"./calendar-jeY8ptxt-BCHjd0Pl-CRCtQXUA.js";/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],q=i("book-open",P);/**
* @license lucide-react v0.510.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const D=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],O=i("chevron-left",D);/**
* @license lucide-react v0.510.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const T=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],z=i("chevron-right",T);/**
* @license lucide-react v0.510.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const _=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],I=i("download",_);/**
* @license lucide-react v0.510.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const K=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],J=i("funnel",K);/**
* @license lucide-react v0.510.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const Q=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],X=i("search",Q),Y=()=>{const l="module";return{fetchAll:async()=>A(`${l}/`),search:async o=>A(`${l}/search?${o}`)}},Z=[{key:"week-1",value:"Week 1"},{key:"week-2",value:"Week 2"},{key:"week-3",value:"Week 3"},{key:"week-4",value:"Week 4"},{key:"week-5",value:"Week 5"},{key:"week-6",value:"Week 6"},{key:"week-7",value:"Week 7"},{key:"week-8",value:"Week 8"},{key:"week-9",value:"Week 9"},{key:"week-10",value:"Week 10"},{key:"week-11",value:"Week 11"},{key:"week-12",value:"Week 12"},{key:"week-13",value:"Week 13"},{key:"week-14",value:"Week 14"},{key:"week-15",value:"Week 15"}],ee=[{key:"",value:"All Grade Level"},{key:"grade-1",value:"Grade 1"},{key:"grade-2",value:"Grade 2"},{key:"grade-3",value:"Grade 3"},{key:"grade-4",value:"Grade 4"},{key:"grade-5",value:"Grade 5"},{key:"grade-6",value:"Grade 6"}],ae=[{key:"english",value:"English"},{key:"math",value:"Math"},{key:"filipino",value:"Filipino"},{key:"science",value:"Science"},{key:"araling panlipunan",value:"Araling Panlipunan"},{key:"esp",value:"ESP"},{key:"tle",value:"TLE"},{key:"mapeh",value:"Mapeh"},{key:"hekasi",value:"Hekasi"}],L=l=>l.split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1).toLowerCase()).join(" "),ue=()=>{const[l,o]=m.useState(1);m.useState({gradeLevel:"",subject:"",week:""});const[r,v]=m.useState([]),[M,se]=m.useState(F),h=Array.isArray(r)?Math.ceil(r.length/5):0,j=(l-1)*5,g=Array.isArray(r)?r.slice(j,j+5):[],k=a=>{var t;a>=1&&a<=h&&(o(a),(t=document.getElementById("results-container"))==null||t.scrollIntoView({behavior:"smooth"}))},f=Y(),{data:d,refetch:le,isLoading:w}=G({queryKey:["apiModules"],queryFn:async()=>await f.fetchAll()});m.useEffect(()=>{d!=null&&d.data&&v(d.data)},[d==null?void 0:d.data]);const{mutateAsync:S,isPending:$}=C({mutationKey:[""],mutationFn:async a=>await f.search(a),onMutate:()=>{},onSuccess:a=>{v(a.data),console.log(a)},onError:a=>{}}),E=async a=>{const t=`${a.week}-${a.subject}-${a.topic}-${a.level}-Module.pdf`,x=a.pdf_url,c=new Promise(async(b,y)=>{try{const s=await fetch(x);if(!s.ok)throw new Error("Network response was not ok");const n=await s.blob(),N=window.URL.createObjectURL(n),u=document.createElement("a");u.href=N,u.download=t,document.body.appendChild(u),u.click(),document.body.removeChild(u),window.URL.revokeObjectURL(N),b()}catch(s){y(s)}});V(c,{pending:"Downloading Module...",success:"Download complete!",error:"Download failed!"},{theme:"light",position:"top-right"})};return e.jsxs("div",{className:"lg:bg-white dark:bg-gray-900 p-6 rounded-xl shadow-sm px-8",children:[e.jsx("div",{className:"lg:mb-10 mb-4 py-2",children:e.jsx("h2",{className:"lg:text-4xl text-2xl font-black text-gray-800 dark:text-white",children:e.jsx("span",{className:"bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-cyan-500",children:"Learning Modules"})})}),e.jsxs("div",{className:"lg:px-40",children:[e.jsxs("div",{className:"panel dark:bg-gray-800 p-6 rounded-lg mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(J,{className:"h-5 w-5 text-blue-600"}),e.jsx("h3",{className:"font-semibold text-gray-700 dark:text-gray-200",children:"Filter Modules"})]}),e.jsx(R,{enableReinitialize:!0,initialValues:M,onSubmit:async(a,t)=>{const x=Object.entries(a).filter(([b,y])=>y!==""),c=new URLSearchParams(x).toString();console.log(c),S(c)},children:({values:a,setFieldValue:t,errors:x,touched:c,isValid:b,isSubmitting:y})=>e.jsxs(U,{className:"",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:"Grade Level"}),e.jsx(p,{name:"level",as:"select",className:"w-full px-4 py-3 rounded-lg border border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all duration-200 outline-none",children:ee.map((s,n)=>e.jsx("option",{value:s.key,children:s.value},n))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:"Subject"}),e.jsx(p,{name:"subject",as:"select",className:"w-full px-4 py-3 rounded-lg border border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all duration-200 outline-none",children:ae.map((s,n)=>e.jsx("option",{value:s.key,children:s.value},n))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:"Week"}),e.jsx(p,{name:"week",as:"select",className:"w-full px-4 py-3 rounded-lg border border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all duration-200 outline-none",children:Z.map((s,n)=>e.jsx("option",{value:s.key,children:s.value},n))})]})]}),e.jsx("div",{className:"flex justify-end items-center py-2",children:e.jsxs("button",{type:"submit",className:"px-4 py-2 text-gray-600 bg-gray-50 border hover:bg-gray-100 rounded-lg transition-colors duration-200 text-sm font-medium flex items-center",children:[e.jsx(X,{className:"h-4 w-4"}),e.jsx("span",{className:"",children:"Filter Results"})]})})]})})]}),e.jsxs("div",{id:"results-container",className:"space-y-4",children:[w&&e.jsx(W,{}),$&&e.jsx(W,{}),(g==null?void 0:g.length)===0&&e.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[e.jsx(q,{className:"mx-auto h-12 w-12 mb-4 opacity-30"}),e.jsx("p",{className:"text-lg font-medium",children:"No modules found"}),e.jsx("p",{className:"text-sm",children:"Try adjusting your filters to find what you're looking for"})]}),g.map((a,t)=>e.jsx("div",{className:" dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl p-5 shadow-md hover:shadow-lg transition-all transform hover:translate-y-px",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"px-2",children:[e.jsxs("div",{className:"lg:flex grid items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xs font-semibold bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 py-2 px-3 rounded-full",children:L(a.week)}),e.jsx("h3",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:L(a.subject)})]}),e.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200",children:a.topic}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:a.description}),e.jsxs("div",{className:"flex items-center gap-1 mt-2 text-xs text-gray-500 dark:text-gray-400",children:[e.jsx(H,{className:"h-3 w-3"}),e.jsx("span",{children:B(a.discussion_date)})]})]}),e.jsx("div",{className:"md:self-end",children:e.jsxs("button",{type:"button",onClick:()=>E(a),disabled:w,className:"px-4 py-2 text-white bg-blue-400 border hover:bg-blue-500 rounded-lg transition-colors duration-200 text-sm font-medium flex items-center",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{className:"ps-1 pt-0.5",children:"Download"})]})})]})},t))]}),r&&(r==null?void 0:r.length)>0&&e.jsx("div",{className:"flex justify-center mt-8",children:e.jsxs("nav",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>k(l-1),disabled:l===1,className:"p-2 rounded-lg enabled:hover:bg-gray-100 dark:enabled:hover:bg-gray-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Previous page",children:e.jsx(O,{className:"h-5 w-5 text-gray-700 dark:text-gray-300"})}),e.jsx("div",{className:"flex space-x-1",children:Array.from({length:h},(a,t)=>t+1).map(a=>e.jsx("button",{onClick:()=>k(a),className:`
                    w-10 h-10 flex items-center justify-center rounded-lg transition-colors
                    ${l===a?"bg-blue-600 text-white font-medium":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}
                  `,children:a},a))}),e.jsx("button",{onClick:()=>k(l+1),disabled:l===h,className:"p-2 rounded-lg enabled:hover:bg-gray-100 dark:enabled:hover:bg-gray-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Next page",children:e.jsx(z,{className:"h-5 w-5 text-gray-700 dark:text-gray-300"})})]})})]})]})};export{ue as default};
