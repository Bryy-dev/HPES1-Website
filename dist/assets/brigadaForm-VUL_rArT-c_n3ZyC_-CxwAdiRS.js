import{M as x,T as F,S as o}from"./index-CkfK2x5R.js";import{B as be,H as xe,W as ve,V as ye,G as M}from"./formik.esm-DCZ0bABG-D05nK4Yh-BZVot_Tu.js";import{t as B}from"./initialStates-C2DwkKKq-B6C2u25H-DZY_zHND.js";import{O as we,b as Ne,E as je,w as te}from"./loader-CUZWE4u1-Bc9zbGhW-DbwShRTX.js";import{f as _e}from"./ErrorMsg-BZ4DWXRX-DbEobzLP-DMSNwLQu.js";var ne={},G={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.getListFiles=t.getImage=t.getBase64=t.getAcceptTypeString=t.openFileDialog=void 0,t.openFileDialog=function(a){a.current&&a.current.click()},t.getAcceptTypeString=function(a,r){return a!=null&&a.length?a.map(function(u){return"."+u}).join(", "):r?"":"image/*"},t.getBase64=function(a){var r=new FileReader;return new Promise(function(u){r.addEventListener("load",function(){return u(String(r.result))}),r.readAsDataURL(a)})},t.getImage=function(a){var r=new Image;return new Promise(function(u){r.addEventListener("load",function(){return u(r)}),r.src=URL.createObjectURL(a)})},t.getListFiles=function(a,r){for(var u=[],p=0;p<a.length;p+=1)u.push(t.getBase64(a[p]));return Promise.all(u).then(function(e){var c=e.map(function(l,f){var n;return n={},n[r]=l,n.file=a[f],n});return c})}})(G);var re={},E={};Object.defineProperty(E,"__esModule",{value:!0});E.DEFAULT_DATA_URL_KEY=E.INIT_MAX_NUMBER=E.DEFAULT_NULL_INDEX=void 0;E.DEFAULT_NULL_INDEX=-1;E.INIT_MAX_NUMBER=1e3;E.DEFAULT_DATA_URL_KEY="dataURL";(function(t){var a=x&&x.__awaiter||function(e,c,l,f){function n(i){return i instanceof l?i:new l(function(m){m(i)})}return new(l||(l=Promise))(function(i,m){function g(h){try{s(f.next(h))}catch(v){m(v)}}function y(h){try{s(f.throw(h))}catch(v){m(v)}}function s(h){h.done?i(h.value):n(h.value).then(g,y)}s((f=f.apply(e,c||[])).next())})},r=x&&x.__generator||function(e,c){var l={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},f,n,i,m;return m={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function g(s){return function(h){return y([s,h])}}function y(s){if(f)throw new TypeError("Generator is already executing.");for(;l;)try{if(f=1,n&&(i=s[0]&2?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return l.label++,{value:s[1],done:!1};case 5:l.label++,n=s[1],s=[0];continue;case 7:s=l.ops.pop(),l.trys.pop();continue;default:if(i=l.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){l=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){l.label=s[1];break}if(s[0]===6&&l.label<i[1]){l.label=i[1],i=s;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(s);break}i[2]&&l.ops.pop(),l.trys.pop();continue}s=c.call(e,l)}catch(h){s=[6,h],n=0}finally{f=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(t,"__esModule",{value:!0}),t.getErrorValidation=t.isMaxNumberValid=t.isAcceptTypeValid=t.isMaxFileSizeValid=t.isImageValid=t.isResolutionValid=void 0;var u=E,p=G;t.isResolutionValid=function(e,c,l,f){if(l===void 0&&(l=0),f===void 0&&(f=1),!l||!f||!e.width||!e.height)return!0;switch(c){case"absolute":{if(e.width===l&&e.height===f)return!0;break}case"ratio":{var n=l/f;if(e.width/e.height===n)return!0;break}case"less":{if(e.width<=l&&e.height<=f)return!0;break}case"more":{if(e.width>=l&&e.height>=f)return!0;break}}return!1},t.isImageValid=function(e){return!!e.includes("image")},t.isMaxFileSizeValid=function(e,c){return c?e<=c:!0},t.isAcceptTypeValid=function(e,c){if(e&&e.length>0){var l=c.split(".").pop()||"";if(e.findIndex(function(f){return f.toLowerCase()===l.toLowerCase()})<0)return!1}return!0},t.isMaxNumberValid=function(e,c,l){if(c!==0&&!c)return!0;if(l===u.DEFAULT_NULL_INDEX){if(e<=c)return!0}else if(e<=c+1)return!0;return!1},t.getErrorValidation=function(e){var c=e.fileList,l=e.value,f=e.maxNumber,n=e.keyUpdate,i=e.acceptType,m=e.maxFileSize,g=e.resolutionType,y=e.resolutionWidth,s=e.resolutionHeight,h=e.allowNonImageType;return a(void 0,void 0,void 0,function(){var v,N,L,j,D;return r(this,function(w){switch(w.label){case 0:return v={},t.isMaxNumberValid(c.length+l.length,f,n)?[3,1]:(v.maxNumber=!0,[3,5]);case 1:N=0,w.label=2;case 2:return N<c.length?(L=c[N].file,L?!h&&!t.isImageValid(L.type)?(v.acceptType=!0,[3,5]):t.isAcceptTypeValid(i,L.name)?t.isMaxFileSizeValid(L.size,m)?g?[4,p.getImage(L)]:[3,4]:(v.maxFileSize=!0,[3,5]):(v.acceptType=!0,[3,5]):[3,4]):[3,5];case 3:if(j=w.sent(),D=t.isResolutionValid(j,g,y,s),!D)return v.resolution=!0,[3,5];w.label=4;case 4:return N+=1,[3,2];case 5:return Object.values(v).find(Boolean)?[2,v]:[2,null]}})})}})(re);var K=x&&x.__assign||function(){return K=Object.assign||function(t){for(var a,r=1,u=arguments.length;r<u;r++){a=arguments[r];for(var p in a)Object.prototype.hasOwnProperty.call(a,p)&&(t[p]=a[p])}return t},K.apply(this,arguments)},Le=x&&x.__createBinding||(Object.create?function(t,a,r,u){u===void 0&&(u=r),Object.defineProperty(t,u,{enumerable:!0,get:function(){return a[r]}})}:function(t,a,r,u){u===void 0&&(u=r),t[u]=a[r]}),De=x&&x.__setModuleDefault||(Object.create?function(t,a){Object.defineProperty(t,"default",{enumerable:!0,value:a})}:function(t,a){t.default=a}),Ee=x&&x.__importStar||function(t){if(t&&t.__esModule)return t;var a={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Le(a,t,r);return De(a,t),a},X=x&&x.__awaiter||function(t,a,r,u){function p(e){return e instanceof r?e:new r(function(c){c(e)})}return new(r||(r=Promise))(function(e,c){function l(i){try{n(u.next(i))}catch(m){c(m)}}function f(i){try{n(u.throw(i))}catch(m){c(m)}}function n(i){i.done?e(i.value):p(i.value).then(l,f)}n((u=u.apply(t,a||[])).next())})},H=x&&x.__generator||function(t,a){var r={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},u,p,e,c;return c={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function l(n){return function(i){return f([n,i])}}function f(n){if(u)throw new TypeError("Generator is already executing.");for(;r;)try{if(u=1,p&&(e=n[0]&2?p.return:n[0]?p.throw||((e=p.return)&&e.call(p),0):p.next)&&!(e=e.call(p,n[1])).done)return e;switch(p=0,e&&(n=[n[0]&2,e.value]),n[0]){case 0:case 1:e=n;break;case 4:return r.label++,{value:n[1],done:!1};case 5:r.label++,p=n[1],n=[0];continue;case 7:n=r.ops.pop(),r.trys.pop();continue;default:if(e=r.trys,!(e=e.length>0&&e[e.length-1])&&(n[0]===6||n[0]===2)){r=0;continue}if(n[0]===3&&(!e||n[1]>e[0]&&n[1]<e[3])){r.label=n[1];break}if(n[0]===6&&r.label<e[1]){r.label=e[1],e=n;break}if(e&&r.label<e[2]){r.label=e[2],r.ops.push(n);break}e[2]&&r.ops.pop(),r.trys.pop();continue}n=a.call(t,r)}catch(i){n=[6,i],p=0}finally{u=e=0}if(n[0]&5)throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}},$=x&&x.__spreadArrays||function(){for(var t=0,a=0,r=arguments.length;a<r;a++)t+=arguments[a].length;for(var u=Array(t),p=0,a=0;a<r;a++)for(var e=arguments[a],c=0,l=e.length;c<l;c++,p++)u[p]=e[c];return u};Object.defineProperty(ne,"__esModule",{value:!0});var _=Ee(F),W=G,Te=re,T=E,ke=function(t){var a=t.value,r=a===void 0?[]:a,u=t.onChange,p=t.onError,e=t.children,c=t.dataURLKey,l=c===void 0?T.DEFAULT_DATA_URL_KEY:c,f=t.multiple,n=f===void 0?!1:f,i=t.maxNumber,m=i===void 0?T.INIT_MAX_NUMBER:i,g=t.acceptType,y=t.maxFileSize,s=t.resolutionWidth,h=t.resolutionHeight,v=t.resolutionType,N=t.inputProps,L=N===void 0?{}:N,j=t.allowNonImageType,D=j===void 0?!1:j,w=r||[],k=_.useRef(null),A=_.useState(T.DEFAULT_NULL_INDEX),I=A[0],P=A[1],Y=_.useState(null),q=Y[0],J=Y[1],Q=_.useState(!1),ae=Q[0],C=Q[1],z=_.useCallback(function(){return W.openFileDialog(k)},[k]),oe=_.useCallback(function(){P(T.DEFAULT_NULL_INDEX),z()},[z]),ie=_.useCallback(function(){u==null||u([])},[u]),le=function(d){var b=$(w);Array.isArray(d)?d.forEach(function(U){b.splice(U,1)}):b.splice(d,1),u==null||u(b)},se=function(d){P(d),z()},ue=function(d){return X(void 0,void 0,void 0,function(){var b;return H(this,function(U){switch(U.label){case 0:return[4,Te.getErrorValidation({fileList:d,maxFileSize:y,maxNumber:m,acceptType:g,keyUpdate:I,resolutionType:v,resolutionWidth:s,resolutionHeight:h,value:w,allowNonImageType:D})];case 1:return b=U.sent(),b?(J(b),p==null||p(b,d),[2,!1]):(q&&J(null),[2,!0])}})})},Z=function(d){return X(void 0,void 0,void 0,function(){var b,U,S,V,ee,R;return H(this,function(O){switch(O.label){case 0:return d?[4,W.getListFiles(d,l)]:[2];case 1:return b=O.sent(),b.length?[4,ue(b)]:[2];case 2:if(U=O.sent(),!U)return[2];if(V=[],I>T.DEFAULT_NULL_INDEX)ee=b[0],S=$(w),S[I]=ee,V.push(I);else if(n)for(S=$(w,b),R=w.length;R<S.length;R+=1)V.push(R);else S=[b[0]],V.push(0);return u==null||u(S,V),[2]}})})},ce=function(d){return X(void 0,void 0,void 0,function(){return H(this,function(b){switch(b.label){case 0:return[4,Z(d.target.files)];case 1:return b.sent(),I>T.DEFAULT_NULL_INDEX&&P(T.DEFAULT_NULL_INDEX),k.current&&(k.current.value=""),[2]}})})},de=_.useMemo(function(){return W.getAcceptTypeString(g,D)},[g,D]),pe=function(d){d.preventDefault(),d.stopPropagation()},fe=function(d){d.preventDefault(),d.stopPropagation(),d.dataTransfer.items&&d.dataTransfer.items.length>0&&C(!0)},ge=function(d){d.preventDefault(),d.stopPropagation(),C(!1)},me=function(d){d.preventDefault(),d.stopPropagation(),C(!1),d.dataTransfer.files&&d.dataTransfer.files.length>0&&Z(d.dataTransfer.files)},he=function(d){d.preventDefault(),d.stopPropagation(),d.dataTransfer.clearData()};return _.default.createElement(_.default.Fragment,null,_.default.createElement("input",K({type:"file",accept:de,ref:k,multiple:n&&I===T.DEFAULT_NULL_INDEX,onChange:ce,style:{display:"none"}},L)),e==null?void 0:e({imageList:w,onImageUpload:oe,onImageRemoveAll:ie,onImageUpdate:se,onImageRemove:le,errors:q,dragProps:{onDrop:me,onDragEnter:fe,onDragLeave:ge,onDragOver:pe,onDragStart:he},isDragging:ae}))},Ae=ne.default=ke;const Ue=()=>{const t="brigada";return{insert:async a=>Ne(`${t}/insert`,a),fetch:async()=>je(`${t}/`),update:async(a,r)=>te(`${t}/${r}/${a}`),remove:async a=>te(`${t}/disable/${a}`)}},Re=({})=>{F.useState(!1);const[t,a]=F.useState(B);F.useState(),F.useState(),F.useState("");const r=Ue(),{mutateAsync:u,isPending:p,isError:e}=be({mutationKey:[""],mutationFn:g=>r.insert(g),onSuccess:()=>{close(),a(B)}}),[c,l]=F.useState([]),f=69,n=(g,y)=>{l(g)},i=g=>{const y=[...c],s=y.splice(g,1)[0];l(y),s==null||s.id},m=async()=>{c.map(g=>g.id),l([])};return o.jsx(o.Fragment,{children:o.jsx(xe,{enableReinitialize:!0,initialValues:t,onSubmit:async(g,y)=>{const s=new FormData,h=c.map(N=>N.file);s.append("email",g.email),s.append("name",g.name),s.append("company",g.company),s.append("contact",g.contact),s.append("amount",g.amount),h.forEach(N=>{s.append("files[]",N)});const v=u(s);ve(v,{pending:"Sending Form Please wait..",success:"Form has been submitted, Thank you",error:"Failed to send request."})},children:({values:g,setFieldValue:y,errors:s,touched:h,isValid:v,isSubmitting:N,resetForm:L})=>o.jsxs(ye,{className:"",children:[e&&o.jsx(_e,{}),p&&o.jsx(we,{}),!p&&!e&&o.jsxs("div",{className:"lg:panel px-2",children:[o.jsx("div",{className:"mb-5 lg:py-2 text-center",children:o.jsx("h2",{className:"lg:text-4xl text-2xl font-black text-gray-800 dark:text-white ",children:o.jsx("span",{className:"bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-cyan-500",children:"Brigada Eskwela Donor Form"})})}),o.jsx("div",{className:"",children:o.jsxs("div",{className:"p-2 text-gray-black  lg:px-20 py-10 bg-white lg:shadow-none lg:border-none lg:rounded-none shadow-xl border rounded-lg ",children:[o.jsxs("div",{className:"grid lg:grid-cols-4 gap-4 lg:px-20 px-4 ",children:[o.jsxs("div",{className:"group lg:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:"Name of Donor"}),o.jsx(M,{type:"text",name:"name",className:"w-full px-4 py-3 rounded-lg border border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all duration-200 outline-none"})]}),o.jsxs("div",{className:"group lg:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:"Company"}),o.jsx(M,{type:"text",name:"company",className:"w-full px-4 py-3 rounded-lg border border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all duration-200 outline-none"})]}),o.jsxs("div",{className:"group lg:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:"Email"}),o.jsx(M,{type:"text",name:"email",className:"w-full px-4 py-3 rounded-lg border border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all duration-200 outline-none"})]}),o.jsxs("div",{className:"group lg:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:"Contact Number"}),o.jsx(M,{type:"text",name:"contact",className:"w-full px-4 py-3 rounded-lg border border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all duration-200 outline-none"})]}),o.jsxs("div",{className:"group lg:col-span-4",children:[o.jsx("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:"Amount Donated"}),o.jsx(M,{type:"text",name:"amount",className:"w-full px-4 py-3 rounded-lg border border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all duration-200 outline-none"})]}),o.jsxs("div",{className:"mt-6  lg:col-span-4",children:[o.jsx("label",{className:"block text-sm font-medium mb-3 text-gray-700",children:"Upload Images (screenshot)"}),o.jsx(Ae,{multiple:!0,value:c,onChange:n,maxNumber:f,children:({imageList:j,onImageUpload:D,onImageRemove:w})=>o.jsxs("div",{className:"space-y-4",children:[j.length>0?o.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[o.jsxs("button",{onClick:D,type:"button",className:"flex items-center gap-2 px-4 py-2 text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-all duration-200",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z",clipRule:"evenodd"})}),"Add more"]}),o.jsxs("button",{onClick:()=>m(),type:"button",className:"flex items-center gap-2 px-4 py-2 text-sm bg-red-50 hover:bg-red-100 text-red-600 rounded-lg transition-all duration-200",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})}),"Clear all"]})]}):o.jsxs("div",{onClick:D,className:"flex flex-col justify-center items-center border-2 border-dashed border-gray-300 rounded-xl bg-gray-50 p-8 cursor-pointer hover:bg-gray-100 transition-all duration-200",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 text-gray-400 mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),o.jsx("p",{className:"text-gray-600 font-medium mb-1",children:"Drag & drop images here"}),o.jsx("p",{className:"text-gray-500 text-sm",children:"or click to browse"})]}),j.length>0&&o.jsx("div",{className:"grid gap-4 sm:grid-cols-3 grid-cols-1 pt-2",children:j.map((k,A)=>o.jsxs("div",{className:"relative group overflow-hidden rounded-lg shadow-sm border border-gray-200",children:[o.jsx("img",{src:k.dataURL,alt:`Upload ${A+1}`,loading:"lazy",className:"w-full h-48 object-cover"}),o.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-40 opacity-0 group-hover:opacity-100 transition-all duration-200 flex items-center justify-center",children:o.jsx("button",{onClick:()=>{w(A),i(A)},type:"button",className:"p-2 bg-white bg-opacity-80 rounded-full hover:bg-opacity-100 transition-all duration-200",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-red-600",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})})]},A))})]})})]})]}),o.jsxs("div",{className:"flex justify-end items-center gap-3 pt-5 mt-4 border-t border-gray-100 px-5 lg:px-0",children:[o.jsx("button",{className:"px-4 py-2 text-gray-600 bg-gray-50 border hover:bg-gray-100 rounded-lg transition-colors duration-200 text-sm font-medium flex items-center",onClick:j=>{j.preventDefault(),a(B),l([]),L()},children:"Clear"}),o.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors duration-200 text-sm font-medium flex items-center shadow-sm",children:"Submit"})]})]})})]})]})})})};export{Re as default};
